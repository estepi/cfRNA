---
title: "Analysis of Maternal plasma cell-free RNA sequencing for preeclamptic and normotensive mothers"
author: "Estefania Mancini"
date: "2022-10-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

# Data description

Liquid biopsies that measure circulating cell-free RNA (cfRNA) offer an unprecedented opportunity to noninvasively study the development of pregnancy-related complications and to bridge gaps in clinical care. Here, we sequenced cfRNA from 404 blood plasma samples (199 pregnant mothers) to identify and validate cfRNA transcriptomic changes that are associated with preeclampsia (PE), a multi-organ syndrome which is the second largest cause of maternal death globally. For each individual, samples were collected at one or more timepoints across gestation. For some, samples were also collected at least once post-partum

```{r readTable, eval=TRUE}
sra<- read.csv("SraRunTable.txt")
sra[1:5,1:5]
colnames(sra)
dim(sra)

```

## Some categorical variables


```{r descCat, eval=TRUE}

data <- data.frame(table(sra$Age))
head(data)

dataSex<-data.frame(table(sra$sex))
head(dataSex)

table(sra$Tissue)

dataDisease<-data.frame(table(sra$disease))
head(dataDisease)

```


# Download data

To retrieve the data from SRA to our instance in AWS, there are some options

## Classical approach: using sratoolkit

source: https://github.com/ncbi/sra-tools



```{bash getsratoolkit, eval=FALSE}

wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-centos_linux64.tar.gz
 tar -zxf sratoolkit.current-centos_linux64.tar.gz 

export PATH=$PATH:$PWD/sratoolkit.3.0.0-centos_linux64/bin
```

### Configure vdb
```{bash configure, eval=FALSE}
vdb-config --interactive
```

Source: https://github.com/ncbi/sra-tools/wiki/05.-Toolkit-Configuration

### Test

```{bash dump, eval=FALSE}
fastq-dump --stdout -X 2 SRR390728
```

### Option more efficient:

Launch using tmux:

```{bash tmux, eval=FALSE}
tmux
```

```{bash fetch, eval=FALSE}

prefetch SRR17332994

fastq-dump --outdir fastq --gzip --skip-technical  --readids --read-filter pass --dumpbase --split-3 --clip SRR17332994 &

```

1 sample: 50 minutes

## Copying from SRA S3 Bucket


```{bash cps3, eval=FALSE}
aws s3 cp s3://sra-pub-sars-cov2/README.txt

aws s3 ls s3://sra-pub-run-odp/sra/SRR17333143/SRR17333143
```

Note: AWS CLI version 2, the latest major version of the AWS CLI, is now stable and recommended for general use. For more information, see the AWS CLI version 2 installation instructions at: https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html

